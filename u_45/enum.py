from enum import Enum

class DIAGNOSIS_TYPE(Enum):
    CONDITION = 1      
    EXIST = 2
    SUDO_CONDITION = 3
    CHECK_AUTH = 4

class FILEPATH(Enum):
    SOLARIS = ["/etc/group", "/usr/bin/su"]
    LINUX = ["/etc/group", "/etc/pam.d/su", "/usr/bin/su"]
    AIX = ["/etc/group", "/etc/security/user", "/usr/bin/su"]
    HP_UX = ["/etc/group", "/etc/default/security", "/usr/bin/su"]

class EXECUTE_COMMAND(Enum):
    SOLARIS = ["ls -al /usr/bin/su", "chgrp security su", "chmod 4750 su"]
    LINUX = []
    AIX = []
    HP_UX = []

class DIAGNOSIS_CONDITIONS(Enum):
    LINUX = [
        {
            "type": DIAGNOSIS_TYPE.SUDO_CONDITION,
            "file_path": FILEPATH.LINUX.value[0],
            "check": "wheel",
            "criterias": ["== 'wheel'"],
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "file_path": FILEPATH.LINUX.value[1],
            "check": "auth required /lib/security/pam_wheel.so debug group",
            "criterias": ["== 'wheel'"],
        },
        {
            "type": DIAGNOSIS_TYPE.EXIST,
            "file_path": FILEPATH.LINUX.value[1],
            "check": "auth required /lib/security/$ISA/pam_wheel.so use_id",
            "criterias": [],
        },
        {
            "type": DIAGNOSIS_TYPE.CHECK_AUTH,
            "file_path": FILEPATH.LINUX.value[2],
            "check": None,
            "criterias": ["== '-rwsr-x---'"],
        },
    ]

    SOLARIS = [
        {
            "type": DIAGNOSIS_TYPE.SUDO_CONDITION,
            "file_path": FILEPATH.SOLARIS.value[0],
            "check": None,
            "criterias": ["== 'wheel'"],
        },
        {
            "type": DIAGNOSIS_TYPE.CHECK_AUTH,
            "file_path": FILEPATH.SOLARIS.value[1],
            "check": None,
            "criterias": ["== '-rwsr-x---'"],
        },
    ]

    AIX = [
        {
            "type": DIAGNOSIS_TYPE.SUDO_CONDITION,
            "file_path": FILEPATH.AIX.value[0],
            "check": None,
            "criterias": ["== 'wheel'"],
        },
        {
            "type": DIAGNOSIS_TYPE.SUDO_CONDITION,
            "file_path": FILEPATH.AIX.value[1],
            "check": "sugroup",
            "criterias": ["== 'staff'"],
        },
        {
            "type": DIAGNOSIS_TYPE.CHECK_AUTH,
            "file_path": FILEPATH.AIX.value[2],
            "check": None,
            "criterias": ["== '-rwsr-x---'"],
        },
    ]

    HP_UX = [
        {
            "type": DIAGNOSIS_TYPE.SUDO_CONDITION,
            "file_path": FILEPATH.HP_UX.value[0],
            "check": None,
            "criterias": ["== 'wheel'"],
        },
        {
            "type": DIAGNOSIS_TYPE.SUDO_CONDITION,
            "file_path": FILEPATH.HP_UX.value[1],
            "check": "SU_ROOT_GROUP",
            "criterias": ["== 'staff'"],
        },
        {
            "type": DIAGNOSIS_TYPE.CHECK_AUTH,
            "file_path": FILEPATH.HP_UX.value[2],
            "check": None,
            "criterias": ["== '-rwsr-x---'"],
        },
    ]