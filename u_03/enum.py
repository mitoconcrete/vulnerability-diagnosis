from enum import Enum

class DIAGNOSIS_TYPE(Enum):
    CONDITION = 1      
    EXIST = 2

class FILEPATH(Enum):
    SOLARIS_UNDER = ["/etc/default/login"]
    SOLARIS_OVER = ["/etc/default/login", "/etc/security/policy.conf"]
    LINUX = ["/etc/pam.d/system-auth"]
    AIX = ["/etc/security/user"]
    HP_UX_UNDER = ["/tcb/files/auth/system/default"]
    HP_UX_OVER = ["/etc/default/security"]

class DIAGNOSIS_CONDITIONS(Enum):
    LINUX = [
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "file_path": FILEPATH.LINUX.value[0],
            "check": "auth required /lib/security/pam_tally.so deny",
            "criterias": ["== 5"],
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "file_path": FILEPATH.LINUX.value[0],
            "check": "unlock_time",
            "criterias": ["== '120 no_magic_root'"],
        },
        {
            "type": DIAGNOSIS_TYPE.EXIST,
            "file_path": FILEPATH.LINUX.value[0],
            "check": "account required /lib/security/pam_tally.so",
            "criterias": [],
        },
        {
            "type": DIAGNOSIS_TYPE.EXIST,
            "file_path": FILEPATH.LINUX.value[0],
            "check": "no_magic_root reset",
            "criterias": []
        }
    ]
    SOLARIS_UNDER = [
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "file_path": FILEPATH.SOLARIS_UNDER.value[0],
            "check": "RETRIES",
            "criterias": ["== 5"]
        }
    ]

    SOLARIS_OVER = [
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "file_path": FILEPATH.SOLARIS_OVER.value[0],
            "check": "RETRIES",
            "criterias": ["== 5"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "file_path": FILEPATH.SOLARIS_OVER.value[1],
            "check": "LOCK_AFTER_RETRIES",
            "criterias": ["== 'YES'"]
        }
    ]

    AIX = [
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "file_path": FILEPATH.AIX.value[0],
            "check": "loginretries",
            "criterias": ["== 10"]
        }
    ]

    HP_UX_UNDER = [
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "file_path": FILEPATH.HP_UX_UNDER.value[0],
            "check": "u_maxtries",
            "criterias": ["== 5"]
        }
    ]

    HP_UX_OVER = [
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "file_path": FILEPATH.HP_UX_OVER.value[0],
            "check": "AUTH_MAXTRIES",
            "criterias": ["== 10"]
        }
    ] 


class OS_VERSION_STANDARD(Enum):
    SOLARIS = 5.9
    HP_UX = 3
