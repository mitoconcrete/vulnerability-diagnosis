from enum import Enum

from common.enum import DIAGNOSIS_TYPE

class FILEPATH(Enum):
    SOLARIS = "/etc/passwd"
    INUX = "/etc/pam.d/system-auth"
    AIX = "/etc/security/user"
    HP_UX = "/etc/passwd"
    LINUX = "/etc/security/pwquality.conf"


class DIAGNOSIS_CONDITIONS(Enum):
    LINUX = [
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.LINUX.value,
            "check": "lcredit",
            "criterias": [">= 1","== -1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.LINUX.value,
            "check": "ucredit",
            "criterias": [">= 1","== -1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.LINUX.value,
            "check": "dcredit",
            "criterias": [">= 1","== -1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.LINUX.value,
            "check": "ocredit",
            "criterias": [">= 1","== -1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.LINUX.value,
            "check": "minlen",
            "criterias": [">= 8","== -1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.LINUX.value,
            "check": "difok",
            "criterias": ["== 'N'","== 10"]
        }
    ]
    SOLARIS = [
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.LINUX.value,
            "check": "HISTORY",
            "criterias": [">= 10"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.LINUX.value,
            "check": "MINDIFF",
            "criterias": [">= 4"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.SOLARIS.value,
            "check": "MINALPHA",
            "criterias": [">= 1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.SOLARIS.value,
            "check": "MINNONALPHA",
            "criterias": [">= 1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.SOLARIS.value,
            "check": "MINUPPER",
            "criterias": [">= 1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.SOLARIS.value,
            "check": "MINLOWER",
            "criterias": [">= 1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.SOLARIS.value,
            "check": "MAXREPEATS",
            "criterias": ["== 0"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.SOLARIS.value,
            "check": "MINSPECIAL",
            "criterias": [">= 1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.SOLARIS.value,
            "check": "MINDIGIT",
            "criterias": [">= 1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.SOLARIS.value,
            "check": "NAMECHECK",
            "criterias": [">= 'YES'"]
        },
    ]
    AIX = [
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.AIX.value,
            "check": "dictionlist",
            "criterias": ["== /usr/share/dict/words"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.AIX.value,
            "check": "histexpire",
            "criterias": ["== 26"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.AIX.value,
            "check": "histsize",
            "criterias": ["== 10"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.AIX.value,
            "check": "maxrepeats",
            "criterias": [">= 2"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.AIX.value,
            "check": "minalpha",
            "criterias": [">= 2"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.AIX.value,
            "check": "minother",
            "criterias": [">= 2"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.AIX.value,
            "check": "mindiff",
            "criterias": ["== 4"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.AIX.value,
            "check": "minlen",
            "criterias": [">= 8"]
        },
    ]
    HP_UX = [
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.HP_UX.value,
            "check": "MIN_PASSWORD_LENGTH",
            "criterias": [">= 8"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.HP_UX.value,
            "check": "PASSWORD_MIN_UPPER_CASE_CHARS",
            "criterias": [">= 1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.HP_UX.value,
            "check": "PASSWORD_MIN_LOWER_CASE_CHARS",
            "criterias": [">= 1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.HP_UX.value,
            "check": "PASSWORD_MIN_DIGIT_CHARS",
            "criterias": [">= 1"]
        },
        {
            "type": DIAGNOSIS_TYPE.CONDITION,
            "filepath": FILEPATH.HP_UX.value,
            "check": "PASSWORD_MIN_SPECIAL_CHARS",
            "criterias": ["== 1"]
        },
    ] 