from u_02.enum import FILEPATH
from u_02.module import diagnosis

from common.module import validate, show_result
from common.connect import SSHClientContextManager

def main(config, os="Linux"):
    with SSHClientContextManager(**config) as client:
        config_filepath = FILEPATH[os.upper()].value
        
        if not validate(client, config_filepath):
            raise Exception("password file is not exist")
        
        abnormality, details = diagnosis(client, os)
        
        show_result(abnormality, details)