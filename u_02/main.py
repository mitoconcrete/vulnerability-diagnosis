from u_02.enum import FILEPATH
from u_02.module import diagnosis

from common.module import validate, show_result
from common.connect import SSHClientContextManager

def main(config, os="LINUX", version=-1):
    with SSHClientContextManager(**config) as client:
        config_filepaths = FILEPATH[os].value
        
        if not all([validate(client, filepath) for filepath in config_filepaths]):
            raise Exception("password file is not exist")
        
        final_result, details = diagnosis(client, os)
        
        show_result(final_result, details)